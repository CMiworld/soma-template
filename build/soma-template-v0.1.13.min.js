/*
soma-template - v0.1.13 - 2013-05-10
http://soundstep.github.com/soma-template/
http://www.soundstep.com
MIT licence 2013
*/
(function(e){"use strict";function t(e){return"[object Array]"===Object.prototype.toString.apply(e)}function n(e){return"object"==typeof e}function i(e){return"string"==typeof e}function r(e){return e?e.nodeType>0:!1}function a(e){return e&&e.nodeType&&3===e.nodeType}function s(e){return e&&"function"==typeof e}function o(e){return null!==e&&void 0!==e}function l(e){return""===e||e===!0||"true"===e||!o(e)}function u(e){return e&&s(e.toString)&&"[object Expression]"==""+e}function h(e){return i(e)?!!e.match(mt.func):!1}function p(e){return e&&e.parent&&Rt.get(e.element)}function c(e){return e.replace(mt.escape,"\\$&")}function d(e,t){var n=lt.start().replace(/\\/g,""),i="",r=t?e:n;r.length>1&&(i="|\\"+r.substr(0,1)+"(?!\\"+r.substr(1,1)+")[^"+r.substr(0,1)+"]*"),mt.sequence=RegExp(lt.start()+".+?"+lt.end()+"|[^"+lt.start()+"]+"+i,"g"),mt.token=RegExp(lt.start()+".*?"+lt.end(),"g"),mt.expression=RegExp(lt.start()+"|"+lt.end(),"gm")}function f(e){return e.replace(mt.trim,"")}function v(e){return mt.string.test(e)?e.substr(1,e.length-2):e}function m(e){return""===e[0]&&e.shift(),""===e[e.length-1]&&e.pop(),e}function g(e){return e.replace(mt.expression,"")}function b(e){return e.replace(mt.depth,"")}function y(e,t){e.parentNode&&e.parentNode.insertBefore(t,e)}function E(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function w(e,t){var n;n=document.documentElement.classList?function(e,t){e.classList.remove(t)}:function(e,t){if(!e||!e.className)return!1;var n=RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$2")},n(e,t)}function N(){function e(){return++i}function t(t){if(t){if("object"!=typeof t)return t;var n;try{n=t.hashkey?t.hashkey:t.hashkey=e()}catch(i){}return n}}var n={},i=1;this.remove=function(e){delete n[t(e)]},this.get=function(e){return n[t(e)]},this.put=function(e,i){n[t(e)]=i},this.has=function(e){return n[t(e)]!==void 0},this.getData=function(){return n},this.dispose=function(){for(var e in n)n.hasOwnProperty(e)&&delete n[e];this.length=0}}function x(e,t){var n=e.match(mt.repeat);if(n){var i=n[2],r=new xt(i);return r.getValue(t)}}function R(e,t,n){var i=e.match(mt.repeat);if(i){var r=i[1];t[r]=n}}function k(e,t){var n=e.node||e.attribute.node,i=n.template.watchers,r=n.element;if(!i)return t;var l=i.get(r);!l&&a(n.element)&&n.parent&&(l=i.get(n.parent.element));var u=l?l:i.get(e.pattern);if(s(u)){var h=u(e.value,t,e.pattern,n.scope,n,e.attribute);if(o(h))return h}return t}function S(e,t){for(var n=L(t),i=e;n>0;)i=i._parent?i._parent:i,n--;return i}function T(e,t){var n=new xt(t);return A(e,n.pattern,n.path,n.params)}function A(e,t,n,i,r,a,l){if(mt.string.test(t))return v(t);var u=[];if(!l&&i)for(var h=0,p=i.length;p>h;h++)u.push(T(e,i[h]));else u=l;if(a)return u;var c=S(e,t);if(t=t.replace(/..\//g,""),n=n.replace(/..\//g,""),!c)return void 0;var d=c,f=n.split(/\.|\[|\]/g);if(f.length>0)for(var m=0,g=f.length;g>m;m++)if(""!==f[m]&&(d=d[f[m]]),!o(d))return c._parent?A(c._parent,t,n,i,r,a,u):void 0;return s(d)?r?d:d.apply(null,u):d}function _(e){var t=e.split("(")[0];return t=b(t)}function P(e){return m(e.split(mt.params))}function L(e){var t=e.split("(")[0],n=t.match(mt.depth);return n?n.length:0}function V(e,t,n){var i=new Et(e,t);i.previousSibling=e.previousSibling,i.nextSibling=e.nextSibling;for(var r,a,s,o=[],l=[],u=e.attributes,h=0,p=u&&u.length;p>h;h++)r=u[h],r.specified&&(a=r.name,s=r.value,a===ot.attributes.skip&&(i.skip=""===s||"true"===s),a===ot.attributes.html&&(i.html=""===s||"true"===s),a!==ot.attributes.repeat||n||(i.repeater=s),($(a+":"+s)||a===ot.attributes.repeat||a===ot.attributes.skip||a===ot.attributes.html||a===ot.attributes.show||a===ot.attributes.hide||a===ot.attributes.href||a===ot.attributes.checked||a===ot.attributes.disabled||a===ot.attributes.multiple||a===ot.attributes.readonly||a===ot.attributes.selected||-1!==s.indexOf(ot.attributes.cloak))&&o.push(new wt(a,s,i)),pt[a]&&!n&&(l.push({name:pt[a],value:s}),o.push(new wt(a,s,i))));i.attributes=o;for(var c=0,d=l.length;d>c;c++)i.addEvent(l[c].name,l[c].value);return i}function $(e){var t=e.match(mt.token);return t&&t.length>0}function D(e){return mt.content.test(e)}function H(e){if(e){var t=e.nodeType;return e&&t?8===t?!1:3!==t||D(e.nodeValue)||$(e.nodeValue)?!0:!1:!1}}function O(e,t,n,i){if(H(t)){var r;if(i?(r=i,r.parent=n):r=V(t,n?n.scope:new yt(st)._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(r.isRepeaterDescendant=!0),r.template=e,!r.skip){for(var a=t.firstChild;a;){var s=O(e,a,r);s&&(s.parent=r,r.children.push(s)),a=a.nextSibling}return r}}}function M(e,t){q(e);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function q(e){for(var t in e)e.hasOwnProperty(t)&&"_"!==t.substr(0,1)&&(e[t]=null,delete e[t])}function C(e){if(!e.repeater&&e.children&&!p(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].update()}function j(e){if(e.children&&!p(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].render()}function I(e){var n,i=x(e.repeater,e.scope);if(t(i)){for(var r=0,a=i.length,s=e.childrenRepeater.length,o=a>s?a:s;o>r;r++)a>r?n=F(e,r,i[r],ht.index,r,n):(e.parent.element.removeChild(e.childrenRepeater[r].element),e.childrenRepeater[r].dispose());e.childrenRepeater.length>i.length&&(e.childrenRepeater.length=i.length)}else{var l=-1;for(var u in i)i.hasOwnProperty(u)&&(l++,n=F(e,l,i[u],ht.key,u,n));for(var h=l;l++<e.childrenRepeater.length-1;)e.parent.element.removeChild(e.childrenRepeater[l].element),e.childrenRepeater[l].dispose();e.childrenRepeater.length=h+1}e.element.parentNode&&e.element.parentNode.removeChild(e.element)}function B(e,t){var n=new Et(e,t.scope._createChild());if(t.attributes){for(var i=[],r=0,a=t.attributes.length;a>r;r++){if(n.renderAsHtml=t.renderAsHtml,t.attributes[r].name===ot.attributes.skip&&(n.skip=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name===ot.attributes.html&&(n.html=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name!==ut.repeat){var s=new wt(t.attributes[r].name,t.attributes[r].value,n);i.push(s)}pt[t.attributes[r].name]&&n.addEvent(pt[t.attributes[r].name],t.attributes[r].value)}n.attributes=i}return n}function F(e,t,n,i,r,a){var s=e.childrenRepeater[t];if(s)return R(e.repeater,s.scope,n),s.scope[i]=r,s.update(),s.render(),s.element;var o=e.element.cloneNode(!0),l=B(o,e);return l.isRepeaterChild=!0,l.parent=e.parent,l.template=e.template,e.childrenRepeater[t]=l,R(e.repeater,l.scope,n),l.scope[i]=r,O(e.template,o,e.parent,l),l.update(),l.render(),a?E(a,o):e.previousSibling?E(e.previousSibling,o):e.nextSibling?y(e.nextSibling,o):e.parent.element.appendChild(o),o}function G(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=G.guid++),e.events||(e.events={});var i=e.events[t];i||(i=e.events[t]={},e["on"+t]&&(i[0]=e["on"+t])),i[n.$$guid]=n,e["on"+t]=function(e){var t=!0;e=e||z(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var i in n)n.hasOwnProperty(i)&&(this.$$handleEvent=n[i],this.$$handleEvent(e)===!1&&(t=!1));return t}}}function W(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function z(e){return e.preventDefault=z.preventDefault,e.stopPropagation=z.stopPropagation,e}function U(e,t,n){St=void 0===n?Number.MAX_VALUE:n,X(e,t,0,!0)}function X(e,t,n,i){if(!r(e))throw Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");if(i&&J(e,t),0!==St)for(var a=e.firstChild;a;)1===a.nodeType&&St>n&&(X(a,t,++n),J(a,t)),a=a.nextSibling}function J(e,t){for(var n,i,r,a=e.attributes,o=0,l=a&&a.length;l>o;o++)if(n=a[o],n.specified&&(i=n.name,r=n.value,pt[i])){var u=K(t,r);u&&s(u)&&(G(e,pt[i],u),At.push({element:e,type:pt[i],handler:u}))}}function K(e,t){var n=t.match(mt.func);if(n){var i=n[1];if(s(e[i]))return e[i]}}function Q(e){for(var t=At.length,n=0;--t>=n;){var i=At[t];(e===i.element||bt(e,i.element))&&(W(i.element,i.type,i.handler),At.splice(t,1))}}function Y(e,t,n){var i=Z(t);n(i,i.scope,i.element,i.node)}function Z(t,n){var a;if(i(t)){if(!r(n))throw Error(e.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=t,a=n}else{if(!r(t))throw Error(e.template.errors.TEMPLATE_NO_PARAM);r(n)?(n.innerHTML=t.innerHTML,a=n):a=t}et(a)&&(et(a).dispose(),Rt.remove(a));var s=new kt(a);return Rt.put(a,s),s}function et(e){return Rt.get(e)}function tt(){var e=Rt.getData();for(var t in Rt.getData())e.hasOwnProperty(t)&&Rt.get(t).render()}function nt(e){if(null===e&&(at={},st={}),o(e)&&n(e))for(var t in e)e.hasOwnProperty(t)&&(at[t]=st[t]=e[t]);return at}e.template=e.template||{},e.template.version="0.1.13",e.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"};var it="{{",rt="}}",at={},st={},ot=e.template.settings=e.template.settings||{};ot.autocreate=!0;var lt=ot.tokens={start:function(e){return o(e)&&""!==e&&(it=c(e),d(e,!0)),it},end:function(e){return o(e)&&""!==e&&(rt=c(e),d(e,!1)),rt}},ut=ot.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},ht=ot.vars={index:"$index",key:"$key"},pt=ot.events={};ot.eventsPrefix="data-";var ct="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy";ct+=" touchstart touchend touchmove touchenter touchleave touchcancel gesturestart gesturechange gestureend";for(var dt=ct.split(" "),ft=-1,vt=dt.length;vt>++ft;)pt[ot.eventsPrefix+dt[ft]]=dt[ft];var mt={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},gt=function(){if("object"!=typeof document)return void 0;for(var e=3,t=!1,n=document.createElement("div");!t;)n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n.getElementsByTagName("i")[0]||(t=!0);return e>4?e:void 0}(),bt="object"!=typeof document?function(){}:document.documentElement.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!!(i&&1===i.nodeType&&n.contains&&n.contains(i))}:document.documentElement.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},yt=function(e){function t(e){var t=n(e);return t._parent=i,i._children.push(t),t}function n(e){var n=e||{};return n._parent=null,n._children=[],n._createChild=function(){return i=n,t.apply(n,arguments)},n}var i;return n(e)},Et=function(e,t){this.element=e,this.scope=t,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,a(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new Nt(this.value,this,void 0))};Et.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var e,t;if(this.children)for(e=0,t=this.children.length;t>e;e++)this.children[e].dispose();if(this.childrenRepeater)for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].dispose();if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(e){var t;if(e===this.element)return this;if(this.childrenRepeater.length>0){for(var n=0,i=this.childrenRepeater.length;i>n;n++)if(t=this.childrenRepeater[n].getNode(e))return t}else for(var r=0,a=this.children.length;a>r;r++)if(t=this.children[r].getNode(e))return t;return null},getAttribute:function(e){if(this.attributes)for(var t=0,n=this.attributes.length;n>t;t++){var i=this.attributes[t];if(i.interpolationName&&i.interpolationName.value===e)return i}},update:function(){if(!p(this)){if(o(this.interpolation)&&this.interpolation.update(),o(this.attributes))for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].update();C(this)}},invalidateData:function(){if(!p(this)){this.invalidate=!0;var e,t;if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].invalidate=!0;for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].invalidateData();for(e=0,t=this.children.length;t>e;e++)this.children[e].invalidateData()}},addEvent:function(e,t){if(!this.repeater){this.eventHandlers[e]&&this.removeEvent(e);var n=this.scope,i=function(e){var i=new xt(t,this.node),r=i.getValue(n,!0),a=i.getValue(n,!1,!0);a.unshift(e),r&&r.apply(null,a)};this.eventHandlers[e]=i,G(this.element,e,i)}},removeEvent:function(e){W(this.element,e,this.eventHandlers[e]),this.eventHandlers[e]=null,delete this.eventHandlers[e]},clearEvents:function(){if(this.eventHandlers)for(var e in this.eventHandlers)this.eventHandlers.hasOwnProperty(e)&&this.removeEvent(e);if(this.children)for(var t=0,n=this.children.length;n>t;t++)this.children[t].clearEvents();if(this.childrenRepeater)for(var i=0,r=this.childrenRepeater.length;r>i;i++)this.childrenRepeater[i].clearEvents()},render:function(){if(!p(this)){if(this.invalidate&&(this.invalidate=!1,a(this.element)&&(this.value=this.parent&&this.parent.html?this.parent.element.innerHTML=this.interpolation.render():this.element.nodeValue=this.interpolation.render())),this.attributes)for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].render();this.repeater?I(this):j(this)}}};var wt=function(e,t,n){this.name=e,this.value=t,this.node=n,this.interpolationName=new Nt(this.name,null,this),this.interpolationValue=new Nt(this.value,null,this),this.invalidate=!1};wt.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function e(e,t){7===gt&&"class"===e?r.className=t:r.setAttribute(e,t)}function t(e,t){l(e)?r.setAttribute(t,t):r.removeAttribute(t)}function n(e){r.setAttribute("src",e)}function i(e){r.setAttribute("href",e)}if(!this.node.repeater){var r=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=o(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=o(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===ut.src?n(this.value):this.name===ut.href?i(this.value):((7!==gt||7===gt&&!this.node.isRepeaterChild)&&this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(7===gt&&"class"===this.previousName?this.node.element.className="":(7!==gt||7===gt&&!this.node.isRepeaterChild)&&this.node.element.removeAttribute(this.previousName)),e(this.name,this.value,this.previousName))),"class"===this.name&&-1!==this.value.indexOf(ot.attributes.cloak)&&w(this.node.element,ot.attributes.cloak),this.name===ut.hide&&(r.style.display=l(this.value)?"none":"block"),this.name===ut.show&&(r.style.display=l(this.value)?"block":"none"),this.name===ut.checked&&(t(this.value,"checked"),r.checked=l(this.value)?!0:!1),this.name===ut.disabled&&t(this.value,"disabled"),this.name===ut.multiple&&t(this.value,"multiple"),this.name===ut.readonly&&(7===gt?r.readOnly=l(this.value)?!0:!1:t(this.value,"readonly")),this.name===ut.selected&&t(this.value,"selected")}}};var Nt=function(e,t,n){this.value=t&&!a(t.element)?f(e):e,this.node=t,this.attribute=n,this.sequence=[],this.expressions=[];var i=this.value.match(mt.sequence);if(i){for(var r=0,s=i.length;s>r;r++)if(i[r].match(mt.token)){var o=new xt(g(i[r]),this.node,this.attribute);this.sequence.push(o),this.expressions.push(o)}else this.sequence.push(i[r]);m(this.sequence)}};Nt.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var e=0,t=this.expressions.length;t>e;e++)this.expressions[e].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){for(var e=-1,t=this.expressions.length;t>++e;)this.expressions[e].update()},render:function(){var e="";if(this.sequence)for(var t=0,n=this.sequence.length;n>t;t++){var i="";i=u(this.sequence[t])?this.sequence[t].value:this.sequence[t],o(i)||(i=""),e+=i}return e}};var xt=function(e,t,n){o(e)&&(this.pattern=e,this.isString=mt.string.test(e),this.node=t,this.attribute=n,this.value=this.isString?this.pattern:void 0,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=h(this.pattern),this.depth=L(this.pattern),this.path=_(this.pattern),this.params=this.isFunction?P(this.pattern.match(mt.func)[2]):null))};xt.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var e=this.node;if(!e&&this.attribute&&(e=this.attribute.node),e||!e.scope){var t=this.getValue(e.scope);t=k(this,t),this.value!==t&&(this.value=t,(this.node||this.attribute).invalidate=!0)}},getValue:function(e,t,n){return A(e,this.pattern,this.path,this.params,t,n)}};var Rt=new N,kt=function(e){this.watchers=new N,this.node=null,this.scope=null,this.compile(e)};kt.prototype={toString:function(){return"[object Template]"},compile:function(e){e&&(this.element=e),this.node&&this.node.dispose(),this.node=O(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(e){o(e)&&M(this.node.scope,e),this.node&&this.node.update()},render:function(e){this.update(e),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(e,t){(i(e)||r(e))&&s(t)&&this.watchers.put(e,t)},unwatch:function(e){this.watchers.remove(e)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(e){return this.node.getNode(e)},dispose:function(){Rt.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},G.guid=1,z.preventDefault=function(){this.returnValue=!1},z.stopPropagation=function(){this.cancelBubble=!0};var St,Tt,At=[];if("object"==typeof document){var Tt=function(){function e(e){for(p=1;e=n.shift();)e()}var t,n=[],i=!1,r=document,a=r.documentElement,s=a.doScroll,o="DOMContentLoaded",l="addEventListener",u="onreadystatechange",h="readyState",p=/^loade|c/.test(r[h]);return r[l]&&r[l](o,t=function(){r.removeEventListener(o,t,i),e()},i),s&&r.attachEvent(u,t=function(){/^c/.test(r[h])&&(r.detachEvent(u,t),e())}),s?function(e){self!=top?p?e():n.push(e):function(){try{a.doScroll("left")}catch(t){return setTimeout(function(){Tt(e)},50)}e()}()}:function(e){p?e():n.push(e)}}();if(ot.autocreate){var _t=function(t){for(var n=t?t.firstChild:document.body;n;){if(1===n.nodeType){_t(n);var i=n.getAttribute(ut.template);if(i){var r=Function("return "+i+";");try{var a=r();s(a)&&e.template.bootstrap(i,n,a)}catch(o){}}}n=n.nextSibling}};Tt(_t)}}lt.start(it),lt.end(rt),e.plugins=e.plugins||{};var Pt=function(instance,injector){instance.constructor.prototype.createTemplate=function(t,n){if(!t||"function"!=typeof t)throw Error("Error creating a template, the first parameter must be a function.");if(n&&r(n)){var i=e.template.create(n);for(var a in i)"function"==typeof i[a]&&(t.prototype[a]=i[a].bind(i));t.prototype.render=i.render.bind(i);var s=injector.createChild();return s.mapValue("template",i),s.mapValue("scope",i.scope),s.mapValue("element",i.element),s.createInstance(t)}return null},e.template.bootstrap=function(e,t,n){instance.createTemplate(n,t)}};e.plugins&&e.plugins.add&&e.plugins.add(Pt),e.template.Plugin=Pt,e.template.create=Z,e.template.get=et,e.template.renderAll=tt,e.template.helpers=nt,e.template.bootstrap=Y,e.template.addEvent=G,e.template.removeEvent=W,e.template.parseEvents=U,e.template.clearEvents=Q,e.template.ready=Tt,"function"==typeof define&&define.amd!==void 0&&define("soma-template",e.template),"undefined"!=typeof module&&module.exports!==void 0&&(module.exports=e.template),"undefined"!=typeof exports&&(exports=e.template)})(this.soma=this.soma||{});