/*! soma-template - v0.1.5 - Romuald Quantin - 2013-01-06
* http://soundstep.github.com/soma-template/
* MIT licence 2013 */
(function(e,t){"use strict";function y(e){return Object.prototype.toString.apply(e)==="[object Array]"}function b(e){return typeof e=="object"}function w(e){return typeof e=="string"}function E(e){return e?e.nodeType>0:!1}function S(e){return e&&e.nodeType&&e.nodeType===3}function x(e){return e&&typeof e=="function"}function T(e){return e!==null&&e!==t}function N(e){return e===""||e===!0||e==="true"||!T(e)}function C(e){return e&&x(e.toString)&&e.toString()==="[object Expression]"}function k(e){return e&&x(e.toString)&&e.toString()==="[object Node]"}function L(e){return w(e)?!!e.match(m.func):!1}function A(e){return e&&e.parent&&dt.get(e.element)}function O(e){return e.replace(m.escape,"\\$&")}function M(e,t){var n=a.start().replace(/\\/g,""),r="",i=t?e:n;i.length>1&&(r="|\\"+i.substr(0,1)+"(?!\\"+i.substr(1,1)+")[^"+i.substr(0,1)+"]*"),m.sequence=new RegExp(a.start()+".+?"+a.end()+"|[^"+a.start()+"]+"+r,"g"),m.token=new RegExp(a.start()+".*?"+a.end(),"g"),m.expression=new RegExp(a.start()+"|"+a.end(),"gm")}function _(e){return e.replace(m.trim,"")}function D(e){return m.string.test(e)?e.substr(1,e.length-2):e}function P(e){return e[0]===""&&e.shift(),e[e.length-1]===""&&e.pop(),e}function H(e){return e.replace(m.expression,"")}function B(e){return e.replace(m.depth,"")}function j(e,t){if(!e.parentNode)return;e.parentNode.insertBefore(t,e)}function F(e,t){if(!e.parentNode)return;e.parentNode.insertBefore(t,e.nextSibling)}function I(e,t){document.documentElement.classList?I=function(e,t){e.classList.remove(t)}:I=function(e,t){if(!e||!e.className)return!1;var n=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$2")},I(e,t)}function R(){function n(){return++t}function r(e){if(!e)return;if(typeof e!="object")return e;var t;try{t=e.hashkey?e.hashkey:e.hashkey=n()}catch(r){}return t}var e={},t=1;this.remove=function(t){delete e[r(t)]},this.get=function(t){return e[r(t)]},this.put=function(t,n){e[r(t)]=n},this.has=function(t){return typeof e[r(t)]!="undefined"},this.getData=function(){return e},this.dispose=function(){for(var t in e)delete e[t];this.length=0}}function U(e,t){var n=e.match(m.repeat);if(!n)return;var r=n[2],i=new pt(r);return i.getValue(t)}function z(e,t,n){var r=e.match(m.repeat);if(!r)return;var i=r[1];t[i]=n}function W(e,t){var n=e.node||e.attribute.node,r=n.template.watchers,i=n.element;if(!r)return t;var s=r.get(i);!s&&S(n.element)&&n.parent&&(s=r.get(n.parent.element));var o=s?s:r.get(e.pattern);if(x(o)){var u=o(e.value,t,e.pattern,n.scope,n,e.attribute);if(T(u))return u}return t}function X(e,t){var n=Q(t),r=e;while(n>0)r=r._parent?r._parent:r,n--;return r}function V(e,t){var n=new pt(t);return $(e,n.pattern,n.path,n.params)}function $(e,n,r,i,s,o,u){if(m.string.test(n))return D(n);var a=[];if(!u&&i)for(var f=0,l=i.length;f<l;f++)a.push(V(e,i[f]));else a=u;if(o)return a;var c=X(e,n);n=n.replace(/..\//g,""),r=r.replace(/..\//g,"");if(!c)return t;var h=c,p=r.split(/\.|\[|\]/g);if(p.length>0)for(var d=0,v=p.length;d<v;d++){p[d]!==""&&(h=h[p[d]]);if(!T(h))return c._parent?$(c._parent,n,r,i,s,o,a):t}return x(h)?s?h:h.apply(null,a):h}function J(e){var t=e.split("(")[0];return t=B(t),t}function K(e){return P(e.split(m.params))}function Q(e){var t=e.split("(")[0],n=t.match(m.depth);return n?n.length:0}function G(e,t,n){var r=new lt(e,t);r.previousSibling=e.previousSibling,r.nextSibling=e.nextSibling;var i=[],s=[];for(var o,a,f,l=e.attributes,h=0,p=l&&l.length;h<p;h++)o=l[h],o.specified&&(a=o.name,f=o.value,a===u.attributes.skip&&(r.skip=f===""||f==="true"),a===u.attributes.html&&(r.html=f===""||f==="true"),a===u.attributes.repeat&&!n&&(r.repeater=f),(Y(a+":"+f)||a===u.attributes.repeat||a===u.attributes.skip||a===u.attributes.html||a===u.attributes.show||a===u.attributes.hide||a===u.attributes.href||a===u.attributes.checked||a===u.attributes.disabled||a===u.attributes.multiple||a===u.attributes.readonly||a===u.attributes.selected||f.indexOf(u.attributes.cloak)!==-1)&&i.push(new ct(a,f,r)),c[a]&&!n&&(s.push({name:c[a],value:f}),i.push(new ct(a,f,r))));r.attributes=i;for(var d=0,v=s.length;d<v;d++)r.addEvent(s[d].name,s[d].value);return r}function Y(e){var t=e.match(m.token);return t&&t.length>0}function Z(e){return m.content.test(e)}function et(e){if(!e)return;var t=e.nodeType;return!e||!t?!1:t===8?!1:t===3&&!Z(e.nodeValue)&&!Y(e.nodeValue)?!1:!0}function tt(e,t,n,r){if(!et(t))return;var i;r?(i=r,i.parent=n):i=G(t,n?n.scope:(new ft(o))._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(i.isRepeaterDescendant=!0),i.template=e;if(i.skip)return;var s=t.firstChild;while(s){var u=tt(e,s,i);u&&(u.parent=i,i.children.push(u)),s=s.nextSibling}return i}function nt(e,t){rt(e);for(var n in t)e[n]=t[n]}function rt(e){for(var t in e)t.substr(0,1)!=="_"&&(e[t]=null,delete e[t])}function it(e){if(e.repeater||!e.children||A(e))return;for(var t=0,n=e.children.length;t<n;t++)e.children[t].update()}function st(e){if(!e.children||A(e))return;for(var t=0,n=e.children.length;t<n;t++)e.children[t].render()}function ot(e){var t=U(e.repeater,e.scope),n;if(y(t)){for(var r=0,i=t.length,s=e.childrenRepeater.length,o=i>s?i:s;r<o;r++)r<i?n=at(e,r,t[r],l.index,r,n):(e.parent.element.removeChild(e.childrenRepeater[r].element),e.childrenRepeater[r].dispose());e.childrenRepeater.length>t.length&&(e.childrenRepeater.length=t.length)}else{var u=-1;for(var a in t)u++,n=at(e,u,t[a],l.key,a,n);var f=u;while(u++<e.childrenRepeater.length-1)e.parent.element.removeChild(e.childrenRepeater[u].element),e.childrenRepeater[u].dispose();e.childrenRepeater.length=f+1}e.element.parentNode&&e.element.parentNode.removeChild(e.element)}function ut(e,t){var n=new lt(e,t.scope._createChild());if(t.attributes){var r=[];for(var i=0,s=t.attributes.length;i<s;i++){n.renderAsHtml=t.renderAsHtml,t.attributes[i].name===u.attributes.skip&&(n.skip=t.attributes[i].value===""||t.attributes[i].value==="true"),t.attributes[i].name===u.attributes.html&&(n.html=t.attributes[i].value===""||t.attributes[i].value==="true");if(t.attributes[i].name!==f.repeat){var o=new ct(t.attributes[i].name,t.attributes[i].value,n);r.push(o)}c[t.attributes[i].name]&&n.addEvent(c[t.attributes[i].name],t.attributes[i].value)}n.attributes=r}return n}function at(e,t,n,r,i,s){var o=e.childrenRepeater[t];if(!o){var u=e.element.cloneNode(!0),a=ut(u,e);return a.isRepeaterChild=!0,a.parent=e.parent,a.template=e.template,e.childrenRepeater[t]=a,z(e.repeater,a.scope,n),a.scope[r]=i,tt(e.template,u,e.parent,a),a.update(),a.render(),s?F(s,u):e.previousSibling?F(e.previousSibling,u):e.nextSibling?j(e.nextSibling,u):e.parent.element.appendChild(u),u}return z(e.repeater,o.scope,n),o.scope[r]=i,o.update(),o.render(),o.element}function mt(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=mt.guid++),e.events||(e.events={});var r=e.events[t];r||(r=e.events[t]={},e["on"+t]&&(r[0]=e["on"+t])),r[n.$$guid]=n,e["on"+t]=yt}}function gt(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function yt(e){var t=!0;e=e||bt(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var r in n)this.$$handleEvent=n[r],this.$$handleEvent(e)===!1&&(t=!1);return t}function bt(e){return e.preventDefault=bt.preventDefault,e.stopPropagation=bt.stopPropagation,e}function St(e,n,r){wt=r===t?Number.MAX_VALUE:r,xt(e,n,0,!0)}function xt(e,t,n,r){if(!E(e))throw new Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");r&&Tt(e,t);if(wt===0)return;var i=e.firstChild;while(i)i.nodeType===1&&n<wt&&(xt(i,t,++n),Tt(i,t)),i=i.nextSibling}function Tt(e,t){var n=[];for(var r,i,s,o=e.attributes,u=0,a=o&&o.length;u<a;u++){r=o[u];if(r.specified){i=r.name,s=r.value;if(c[i]){var f=Nt(t,s,e);f&&x(f)&&(mt(e,c[i],f),Et.push({element:e,type:c[i],handler:f}))}}}}function Nt(e,t,n){var r=t.match(m.func);if(r){var i=r[1];if(x(e[i]))return e[i]}}function Ct(e){var t=Et.length,n=0;while(--t>=n){var r=Et[t];if(e===r.element||q(e,r.element))gt(r.element,r.type,r.handler),Et.splice(t,1)}}function At(e,t,n){var r=Ot(t);n(r,r.scope,r.element,r.node)}function Ot(t,n){var r;if(w(t)){if(!E(n))throw new Error(e.template.errors.TEMPLATE_STRING_NO_ELEMENT);n.innerHTML=t,r=n}else{if(!E(t))throw new Error(e.template.errors.TEMPLATE_NO_PARAM);E(n)?(n.innerHTML=t.innerHTML,r=n):r=t}Mt(r)&&(Mt(r).dispose(),dt.remove(r));var i=new vt(r);return dt.put(r,i),i}function Mt(e){return dt.get(e)}function _t(){for(var e in dt.getData())dt.get(e).render()}function Dt(e){e===null&&(s={},o={});if(T(e)&&b(e))for(var t in e)e.hasOwnProperty(t)&&(s[t]=o[t]=e[t]);return s}function Pt(t,n){t.constructor.prototype.createTemplate=function(t,n){if(!t||typeof t!="function")throw new Error("Error creating a template, the first parameter must be a function.");if(n&&E(n)){var r=e.template.create(n);for(var i in r)typeof r[i]=="function"&&(t.prototype[i]=r[i].bind(r));t.prototype.render=r.render.bind(r);var s=this.injector.createChild();return s.mapValue("template",r),s.mapValue("scope",r.scope),s.mapValue("element",r.element),s.createInstance(t)}return null},e.template.bootstrap=function(e,n,r){t.createTemplate(r,n)}}e.template=e.template||{},e.template.version="0.1.5";var n=e.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"},r="{{",i="}}",s={},o={},u=e.template.settings=e.template.settings||{};u.autocreate=!0;var a=u.tokens={start:function(e){return T(e)&&e!==""&&(r=O(e),M(e,!0)),r},end:function(e){return T(e)&&e!==""&&(i=O(e),M(e,!1)),i}},f=u.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},l=u.vars={index:"$index",key:"$key"},c=u.events={};u.eventsPrefix="data-";var h="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy",p=h.split(" "),d=-1,v=p.length;while(++d<v)c[u.eventsPrefix+p[d]]=p[d];var m={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},g=function(){if(typeof document!="object")return t;var e,n=3,r=document.createElement("div"),i=r.getElementsByTagName("i");while(r.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",i[0]);return n>4?n:e}(),q=typeof document!="object"?function(){}:document.documentElement.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:document.documentElement.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},ft=function(e){function t(e){var t=n(e);return t._parent=this,this._children.push(t),t}function n(e){var n=e||{};return n._parent=null,n._children=[],n._createChild=function(e){return t.apply(n,arguments)},n}return n(e)},lt=function(e,n){this.element=e,this.scope=n,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,S(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new ht(this.value,this,t))};lt.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var e,t;if(this.children)for(e=0,t=this.children.length;e<t;e++)this.children[e].dispose();if(this.childrenRepeater)for(e=0,t=this.childrenRepeater.length;e<t;e++)this.childrenRepeater[e].dispose();if(this.attributes)for(e=0,t=this.attributes.length;e<t;e++)this.attributes[e].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(e){var t;if(e===this.element)return this;if(this.childrenRepeater.length>0)for(var n=0,r=this.childrenRepeater.length;n<r;n++){t=this.childrenRepeater[n].getNode(e);if(t)return t}else for(var i=0,s=this.children.length;i<s;i++){t=this.children[i].getNode(e);if(t)return t}return null},getAttribute:function(e){if(this.attributes)for(var t=0,n=this.attributes.length;t<n;t++){var r=this.attributes[t];if(r.interpolationName&&r.interpolationName.value===e)return r}},update:function(){if(A(this))return;T(this.interpolation)&&this.interpolation.update();if(T(this.attributes))for(var e=0,t=this.attributes.length;e<t;e++)this.attributes[e].update();it(this)},invalidateData:function(){if(A(this))return;this.invalidate=!0;var e,t;if(this.attributes)for(e=0,t=this.attributes.length;e<t;e++)this.attributes[e].invalidate=!0;for(e=0,t=this.childrenRepeater.length;e<t;e++)this.childrenRepeater[e].invalidateData();for(e=0,t=this.children.length;e<t;e++)this.children[e].invalidateData()},addEvent:function(e,t){if(this.repeater)return;this.eventHandlers[e]&&this.removeEvent(e);var n=this.scope,r=function(e){var r=new pt(t,this.node),i=r.getValue(n,!0),s=r.getValue(n,!1,!0);s.unshift(e),i&&i.apply(null,s)};this.eventHandlers[e]=r,mt(this.element,e,r)},removeEvent:function(e){gt(this.element,e,this.eventHandlers[e]),this.eventHandlers[e]=null,delete this.eventHandlers[e]},clearEvents:function(){if(this.eventHandlers)for(var e in this.eventHandlers)this.removeEvent(e,this.eventHandlers[e]);if(this.children)for(var t=0,n=this.children.length;t<n;t++)this.children[t].clearEvents();if(this.childrenRepeater)for(var r=0,i=this.childrenRepeater.length;r<i;r++)this.childrenRepeater[r].clearEvents()},render:function(){if(A(this))return;this.invalidate&&(this.invalidate=!1,S(this.element)&&(this.parent&&this.parent.html?this.value=this.parent.element.innerHTML=this.interpolation.render():this.value=this.element.nodeValue=this.interpolation.render()));if(this.attributes)for(var e=0,t=this.attributes.length;e<t;e++)this.attributes[e].render();this.repeater?ot(this):st(this)}};var ct=function(e,t,n){this.name=e,this.value=t,this.node=n,this.interpolationName=new ht(this.name,null,this),this.interpolationValue=new ht(this.value,null,this),this.invalidate=!1};ct.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function t(t,n){g===7&&t==="class"?e.className=n:e.setAttribute(t,n)}function n(t,n,r){N(n)?e.setAttribute(r,r):e.removeAttribute(r)}function r(t,n){e.setAttribute("src",n)}function i(t,n){e.setAttribute("href",n)}if(this.node.repeater)return;var e=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=T(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=T(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===f.src?r(this.name,this.value):this.name===f.href?i(this.name,this.value):((!this.node.isRepeaterChild||g!==7)&&this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(g===7&&this.previousName==="class"?this.node.element.className="":(!this.node.isRepeaterChild||g!==7)&&this.node.element.removeAttribute(this.previousName)),t(this.name,this.value,this.previousName))),this.name==="class"&&this.value.indexOf(u.attributes.cloak)!==-1&&I(this.node.element,u.attributes.cloak),this.name===f.hide&&(e.style.display=N(this.value)?"none":"block"),this.name===f.show&&(e.style.display=N(this.value)?"block":"none"),this.name===f.checked&&(n(this.name,this.value,"checked"),e.checked=N(this.value)?!0:!1),this.name===f.disabled&&n(this.name,this.value,"disabled"),this.name===f.multiple&&n(this.name,this.value,"multiple"),this.name===f.readonly&&(g===7?e.readOnly=N(this.value)?!0:!1:n(this.name,this.value,"readonly")),this.name===f.selected&&n(this.name,this.value,"selected")}};var ht=function(e,t,n){this.value=t&&!S(t.element)?_(e):e,this.node=t,this.attribute=n,this.sequence=[],this.expressions=[];var r=this.value.match(m.sequence);if(r){for(var i=0,s=r.length;i<s;i++)if(r[i].match(m.token)){var o=new pt(H(r[i]),this.node,this.attribute);this.sequence.push(o),this.expressions.push(o)}else this.sequence.push(r[i]);P(this.sequence)}};ht.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var e=0,t=this.expressions.length;e<t;e++)this.expressions[e].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){var e=-1,t=this.expressions.length;while(++e<t)this.expressions[e].update()},render:function(){var e="";if(this.sequence)for(var t=0,n=this.sequence.length;t<n;t++){var r="";C(this.sequence[t])?r=this.sequence[t].value:r=this.sequence[t],T(r)||(r=""),e+=r}return e}};var pt=function(e,n,r){if(!T(e))return;this.pattern=e,this.isString=m.string.test(e),this.node=n,this.attribute=r,this.value=this.isString?this.pattern:t,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=L(this.pattern),this.depth=Q(this.pattern),this.path=J(this.pattern),this.params=this.isFunction?K(this.pattern.match(m.func)[2]):null)};pt.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var e=this.node;!e&&this.attribute&&(e=this.attribute.node);if(!e&&e.scope)return;var t=this.getValue(e.scope);t=W(this,t),this.value!==t&&(this.value=t,(this.node||this.attribute).invalidate=!0)},getValue:function(e,t,n){return $(e,this.pattern,this.path,this.params,t,n)}};var dt=new R,vt=function(e){this.watchers=new R,this.node=null,this.scope=null,this.compile(e)};vt.prototype={toString:function(){return"[object Template]"},compile:function(e){e&&(this.element=e),this.node&&this.node.dispose(),this.node=tt(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(e){T(e)&&nt(this.node.scope,e),this.node&&this.node.update()},render:function(e){this.update(e),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(e,t){if(!w(e)&&!E(e)||!x(t))return;this.watchers.put(e,t)},unwatch:function(e){this.watchers.remove(e)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(e){return this.node.getNode(e)},dispose:function(){dt.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},mt.guid=1,bt.preventDefault=function(){this.returnValue=!1},bt.stopPropagation=function(){this.cancelBubble=!0};var wt,Et=[];if(u.autocreate&&typeof document=="object"){var kt=function(){function e(e){for(c=1;e=n.shift();)e()}var t,n=[],r=!1,i=document,s=i.documentElement,o=s.doScroll,u="DOMContentLoaded",a="addEventListener",f="onreadystatechange",l="readyState",c=/^loade|c/.test(i[l]);return i[a]&&i[a](u,t=function(){i.removeEventListener(u,t,r),e()},r),o&&i.attachEvent(f,t=function(){/^c/.test(i[l])&&(i.detachEvent(f,t),e())}),o?function(e){self!=top?c?e():n.push(e):function(){try{s.doScroll("left")}catch(t){return setTimeout(function(){kt(e)},50)}e()}()}:function(e){c?e():n.push(e)}}(),Lt=function(t){var n=t?t.firstChild:document.body;while(n){if(n.nodeType===1){Lt(n);var r=n.getAttribute(f.template);if(r){var i=new Function("return "+r+";");try{var s=i();x(s)&&e.template.bootstrap(r,n,s)}catch(o){}}}n=n.nextSibling}};kt(Lt)}a.start(r),a.end(i),e.plugins=e.plugins||{},e.plugins&&e.plugins.add&&e.plugins.add(Pt),e.template.create=Ot,e.template.get=Mt,e.template.renderAll=_t,e.template.helpers=Dt,e.template.bootstrap=At,e.template.addEvent=mt,e.template.removeEvent=gt,e.template.parseEvents=St,e.template.clearEvents=Ct,e.template.ready=kt,typeof define=="function"&&define.amd&&define("soma-template",e.template),typeof exports!="undefined"&&(typeof module!="undefined"&&module.exports&&(exports=module.exports=e.template),exports=e.template)})(this.soma=this.soma||{});