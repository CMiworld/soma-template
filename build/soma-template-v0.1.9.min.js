/*
soma-template - v0.1.9 - 2013-05-10
http://soundstep.github.com/soma-template/
http://www.soundstep.com
MIT licence 2013
*/
(function(){"use strict";function e(e){return"[object Array]"===Object.prototype.toString.apply(e)}function t(e){return"object"==typeof e}function n(e){return"string"==typeof e}function i(e){return e?e.nodeType>0:!1}function r(e){return e&&e.nodeType&&3===e.nodeType}function a(e){return e&&"function"==typeof e}function s(e){return null!==e&&void 0!==e}function o(e){return""===e||e===!0||"true"===e||!s(e)}function l(e){return e&&a(e.toString)&&"[object Expression]"==""+e}function u(e){return n(e)?!!e.match(mt.func):!1}function h(e){return e&&e.parent&&kt.get(e.element)}function p(e){return e.replace(mt.escape,"\\$&")}function c(e,t){var n=lt.start().replace(/\\/g,""),i="",r=t?e:n;r.length>1&&(i="|\\"+r.substr(0,1)+"(?!\\"+r.substr(1,1)+")[^"+r.substr(0,1)+"]*"),mt.sequence=RegExp(lt.start()+".+?"+lt.end()+"|[^"+lt.start()+"]+"+i,"g"),mt.token=RegExp(lt.start()+".*?"+lt.end(),"g"),mt.expression=RegExp(lt.start()+"|"+lt.end(),"gm")}function d(e){return e.replace(mt.trim,"")}function f(e){return mt.string.test(e)?e.substr(1,e.length-2):e}function v(e){return""===e[0]&&e.shift(),""===e[e.length-1]&&e.pop(),e}function m(e){return e.replace(mt.expression,"")}function g(e){return e.replace(mt.depth,"")}function b(e,t){e.parentNode&&e.parentNode.insertBefore(t,e)}function y(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function E(e,t){var n;n=document.documentElement.classList?function(e,t){e.classList.remove(t)}:function(e,t){if(!e||!e.className)return!1;var n=RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(n,"$2")},n(e,t)}function w(){function e(){return++i}function t(t){if(t){if("object"!=typeof t)return t;var n;try{n=t.hashkey?t.hashkey:t.hashkey=e()}catch(i){}return n}}var n={},i=1;this.remove=function(e){delete n[t(e)]},this.get=function(e){return n[t(e)]},this.put=function(e,i){n[t(e)]=i},this.has=function(e){return n[t(e)]!==void 0},this.getData=function(){return n},this.dispose=function(){for(var e in n)n.hasOwnProperty(e)&&delete n[e];this.length=0}}function N(e,t){var n=e.match(mt.repeat);if(n){var i=n[2],r=new Rt(i);return r.getValue(t)}}function R(e,t,n){var i=e.match(mt.repeat);if(i){var r=i[1];t[r]=n}}function k(e,t){var n=e.node||e.attribute.node,i=n.template.watchers,o=n.element;if(!i)return t;var l=i.get(o);!l&&r(n.element)&&n.parent&&(l=i.get(n.parent.element));var u=l?l:i.get(e.pattern);if(a(u)){var h=u(e.value,t,e.pattern,n.scope,n,e.attribute);if(s(h))return h}return t}function x(e,t){for(var n=P(t),i=e;n>0;)i=i._parent?i._parent:i,n--;return i}function S(e,t){var n=new Rt(t);return T(e,n.pattern,n.path,n.params)}function T(e,t,n,i,r,o,l){if(mt.string.test(t))return f(t);var u=[];if(!l&&i)for(var h=0,p=i.length;p>h;h++)u.push(S(e,i[h]));else u=l;if(o)return u;var c=x(e,t);if(t=t.replace(/..\//g,""),n=n.replace(/..\//g,""),!c)return void 0;var d=c,v=n.split(/\.|\[|\]/g);if(v.length>0)for(var m=0,g=v.length;g>m;m++)if(""!==v[m]&&(d=d[v[m]]),!s(d))return c._parent?T(c._parent,t,n,i,r,o,u):void 0;return a(d)?r?d:d.apply(null,u):d}function A(e){var t=e.split("(")[0];return t=g(t)}function _(e){return v(e.split(mt.params))}function P(e){var t=e.split("(")[0],n=t.match(mt.depth);return n?n.length:0}function L(e,t,n){var i=new Et(e,t);i.previousSibling=e.previousSibling,i.nextSibling=e.nextSibling;for(var r,a,s,o=[],l=[],u=e.attributes,h=0,p=u&&u.length;p>h;h++)r=u[h],r.specified&&(a=r.name,s=r.value,a===ot.attributes.skip&&(i.skip=""===s||"true"===s),a===ot.attributes.html&&(i.html=""===s||"true"===s),a!==ot.attributes.repeat||n||(i.repeater=s),(V(a+":"+s)||a===ot.attributes.repeat||a===ot.attributes.skip||a===ot.attributes.html||a===ot.attributes.show||a===ot.attributes.hide||a===ot.attributes.href||a===ot.attributes.checked||a===ot.attributes.disabled||a===ot.attributes.multiple||a===ot.attributes.readonly||a===ot.attributes.selected||-1!==s.indexOf(ot.attributes.cloak))&&o.push(new wt(a,s,i)),pt[a]&&!n&&(l.push({name:pt[a],value:s}),o.push(new wt(a,s,i))));i.attributes=o;for(var c=0,d=l.length;d>c;c++)i.addEvent(l[c].name,l[c].value);return i}function V(e){var t=e.match(mt.token);return t&&t.length>0}function $(e){return mt.content.test(e)}function D(e){if(e){var t=e.nodeType;return e&&t?8===t?!1:3!==t||$(e.nodeValue)||V(e.nodeValue)?!0:!1:!1}}function H(e,t,n,i){if(D(t)){var r;if(i?(r=i,r.parent=n):r=L(t,n?n.scope:new yt(st)._createChild(),n&&(n.repeater||n.isRepeaterDescendant)),n&&(n.repeater||n.isRepeaterDescendant)&&(r.isRepeaterDescendant=!0),r.template=e,!r.skip){for(var a=t.firstChild;a;){var s=H(e,a,r);s&&(s.parent=r,r.children.push(s)),a=a.nextSibling}return r}}}function O(e,t){M(e);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function M(e){for(var t in e)e.hasOwnProperty(t)&&"_"!==t.substr(0,1)&&(e[t]=null,delete e[t])}function q(e){if(!e.repeater&&e.children&&!h(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].update()}function C(e){if(e.children&&!h(e))for(var t=0,n=e.children.length;n>t;t++)e.children[t].render()}function j(t){var n,i=N(t.repeater,t.scope);if(e(i)){for(var r=0,a=i.length,s=t.childrenRepeater.length,o=a>s?a:s;o>r;r++)a>r?n=B(t,r,i[r],ht.index,r,n):(t.parent.element.removeChild(t.childrenRepeater[r].element),t.childrenRepeater[r].dispose());t.childrenRepeater.length>i.length&&(t.childrenRepeater.length=i.length)}else{var l=-1;for(var u in i)i.hasOwnProperty(u)&&(l++,n=B(t,l,i[u],ht.key,u,n));for(var h=l;l++<t.childrenRepeater.length-1;)t.parent.element.removeChild(t.childrenRepeater[l].element),t.childrenRepeater[l].dispose();t.childrenRepeater.length=h+1}t.element.parentNode&&t.element.parentNode.removeChild(t.element)}function I(e,t){var n=new Et(e,t.scope._createChild());if(t.attributes){for(var i=[],r=0,a=t.attributes.length;a>r;r++){if(n.renderAsHtml=t.renderAsHtml,t.attributes[r].name===ot.attributes.skip&&(n.skip=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name===ot.attributes.html&&(n.html=""===t.attributes[r].value||"true"===t.attributes[r].value),t.attributes[r].name!==ut.repeat){var s=new wt(t.attributes[r].name,t.attributes[r].value,n);i.push(s)}pt[t.attributes[r].name]&&n.addEvent(pt[t.attributes[r].name],t.attributes[r].value)}n.attributes=i}return n}function B(e,t,n,i,r,a){var s=e.childrenRepeater[t];if(s)return R(e.repeater,s.scope,n),s.scope[i]=r,s.update(),s.render(),s.element;var o=e.element.cloneNode(!0),l=I(o,e);return l.isRepeaterChild=!0,l.parent=e.parent,l.template=e.template,e.childrenRepeater[t]=l,R(e.repeater,l.scope,n),l.scope[i]=r,H(e.template,o,e.parent,l),l.update(),l.render(),a?y(a,o):e.previousSibling?y(e.previousSibling,o):e.nextSibling?b(e.nextSibling,o):e.parent.element.appendChild(o),o}function F(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=F.guid++),e.events||(e.events={});var i=e.events[t];i||(i=e.events[t]={},e["on"+t]&&(i[0]=e["on"+t])),i[n.$$guid]=n,e["on"+t]=function(e){var t=!0;e=e||W(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var i in n)n.hasOwnProperty(i)&&(this.$$handleEvent=n[i],this.$$handleEvent(e)===!1&&(t=!1));return t}}}function G(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.events&&e.events[t]&&delete e.events[t][n.$$guid]}function W(e){return e.preventDefault=W.preventDefault,e.stopPropagation=W.stopPropagation,e}function z(e,t,n){St=void 0===n?Number.MAX_VALUE:n,U(e,t,0,!0)}function U(e,t,n,r){if(!i(e))throw Error("Error in soma.template.parseEvents, only a DOM Element can be parsed.");if(r&&X(e,t),0!==St)for(var a=e.firstChild;a;)1===a.nodeType&&St>n&&(U(a,t,++n),X(a,t)),a=a.nextSibling}function X(e,t){for(var n,i,r,s=e.attributes,o=0,l=s&&s.length;l>o;o++)if(n=s[o],n.specified&&(i=n.name,r=n.value,pt[i])){var u=J(t,r);u&&a(u)&&(F(e,pt[i],u),Tt.push({element:e,type:pt[i],handler:u}))}}function J(e,t){var n=t.match(mt.func);if(n){var i=n[1];if(a(e[i]))return e[i]}}function K(e){for(var t=Tt.length,n=0;--t>=n;){var i=Tt[t];(e===i.element||bt(e,i.element))&&(G(i.element,i.type,i.handler),Tt.splice(t,1))}}function Q(e,t,n){var i=Y(t);n(i,i.scope,i.element,i.node)}function Y(e,t){var r;if(n(e)){if(!i(t))throw Error(nt.template.errors.TEMPLATE_STRING_NO_ELEMENT);t.innerHTML=e,r=t}else{if(!i(e))throw Error(nt.template.errors.TEMPLATE_NO_PARAM);i(t)?(t.innerHTML=e.innerHTML,r=t):r=e}Z(r)&&(Z(r).dispose(),kt.remove(r));var a=new xt(r);return kt.put(r,a),a}function Z(e){return kt.get(e)}function et(){var e=kt.getData();for(var t in kt.getData())e.hasOwnProperty(t)&&kt.get(t).render()}function tt(e){if(null===e&&(at={},st={}),s(e)&&t(e))for(var n in e)e.hasOwnProperty(n)&&(at[n]=st[n]=e[n]);return at}var nt=nt||{};nt.template=nt.template||{},nt.template.version="0.1.9",nt.template.errors={TEMPLATE_STRING_NO_ELEMENT:"Error in soma.template, a string template requirement a second parameter: an element target - soma.template.create('string', element)",TEMPLATE_NO_PARAM:"Error in soma.template, a template requires at least 1 parameter - soma.template.create(element)"};var it="{{",rt="}}",at={},st={},ot=nt.template.settings=nt.template.settings||{};ot.autocreate=!0;var lt=ot.tokens={start:function(e){return s(e)&&""!==e&&(it=p(e),c(e,!0)),it},end:function(e){return s(e)&&""!==e&&(rt=p(e),c(e,!1)),rt}},ut=ot.attributes={skip:"data-skip",repeat:"data-repeat",src:"data-src",href:"data-href",show:"data-show",hide:"data-hide",cloak:"data-cloak",checked:"data-checked",disabled:"data-disabled",multiple:"data-multiple",readonly:"data-readonly",selected:"data-selected",template:"data-template",html:"data-html"},ht=ot.vars={index:"$index",key:"$key"},pt=ot.events={};ot.eventsPrefix="data-";var ct="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup focus blur change select selectstart scroll copy cut paste mousewheel keypress error contextmenu input textinput drag dragenter dragleave dragover dragend dragstart dragover drop load submit reset search resize beforepaste beforecut beforecopy";ct+=" touchstart touchend touchmove touchenter touchleave touchcancel gesturestart gesturechange gestureend";for(var dt=ct.split(" "),ft=-1,vt=dt.length;vt>++ft;)pt[ot.eventsPrefix+dt[ft]]=dt[ft];var mt={sequence:null,token:null,expression:null,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,trim:/^[\s+]+|[\s+]+$/g,repeat:/(.*)\s+in\s+(.*)/,func:/(.*)\((.*)\)/,params:/,\s+|,|\s+,\s+/,quote:/\"|\'/g,content:/[^.|^\s]/gm,depth:/..\//g,string:/^(\"|\')(.*)(\"|\')$/},gt=function(){if("object"!=typeof document)return void 0;for(var e=3,t=!1,n=document.createElement("div");!t;)n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n.getElementsByTagName("i")[0]||(t=!0);return e>4?e:void 0}(),bt="object"!=typeof document?function(){}:document.documentElement.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!!(i&&1===i.nodeType&&n.contains&&n.contains(i))}:document.documentElement.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},yt=function(e){function t(e){var t=n(e);return t._parent=i,i._children.push(t),t}function n(e){var n=e||{};return n._parent=null,n._children=[],n._createChild=function(){return i=n,t.apply(n,arguments)},n}var i;return n(e)},Et=function(e,t){this.element=e,this.scope=t,this.attributes=null,this.value=null,this.interpolation=null,this.invalidate=!1,this.skip=!1,this.repeater=null,this.isRepeaterDescendant=!1,this.isRepeaterChild=!1,this.parent=null,this.children=[],this.childrenRepeater=[],this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers={},this.html=!1,r(this.element)&&(this.value=this.element.nodeValue,this.interpolation=new Nt(this.value,this,void 0))};Et.prototype={toString:function(){return"[object Node]"},dispose:function(){this.clearEvents();var e,t;if(this.children)for(e=0,t=this.children.length;t>e;e++)this.children[e].dispose();if(this.childrenRepeater)for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].dispose();if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].dispose();this.interpolation&&this.interpolation.dispose(),this.element=null,this.scope=null,this.attributes=null,this.attributesHashMap=null,this.value=null,this.interpolation=null,this.repeater=null,this.parent=null,this.children=null,this.childrenRepeater=null,this.previousSibling=null,this.nextSibling=null,this.template=null,this.eventHandlers=null},getNode:function(e){var t;if(e===this.element)return this;if(this.childrenRepeater.length>0){for(var n=0,i=this.childrenRepeater.length;i>n;n++)if(t=this.childrenRepeater[n].getNode(e))return t}else for(var r=0,a=this.children.length;a>r;r++)if(t=this.children[r].getNode(e))return t;return null},getAttribute:function(e){if(this.attributes)for(var t=0,n=this.attributes.length;n>t;t++){var i=this.attributes[t];if(i.interpolationName&&i.interpolationName.value===e)return i}},update:function(){if(!h(this)){if(s(this.interpolation)&&this.interpolation.update(),s(this.attributes))for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].update();q(this)}},invalidateData:function(){if(!h(this)){this.invalidate=!0;var e,t;if(this.attributes)for(e=0,t=this.attributes.length;t>e;e++)this.attributes[e].invalidate=!0;for(e=0,t=this.childrenRepeater.length;t>e;e++)this.childrenRepeater[e].invalidateData();for(e=0,t=this.children.length;t>e;e++)this.children[e].invalidateData()}},addEvent:function(e,t){if(!this.repeater){this.eventHandlers[e]&&this.removeEvent(e);var n=this.scope,i=function(e){var i=new Rt(t,this.node),r=i.getValue(n,!0),a=i.getValue(n,!1,!0);a.unshift(e),r&&r.apply(null,a)};this.eventHandlers[e]=i,F(this.element,e,i)}},removeEvent:function(e){G(this.element,e,this.eventHandlers[e]),this.eventHandlers[e]=null,delete this.eventHandlers[e]},clearEvents:function(){if(this.eventHandlers)for(var e in this.eventHandlers)this.eventHandlers.hasOwnProperty(e)&&this.removeEvent(e);if(this.children)for(var t=0,n=this.children.length;n>t;t++)this.children[t].clearEvents();if(this.childrenRepeater)for(var i=0,r=this.childrenRepeater.length;r>i;i++)this.childrenRepeater[i].clearEvents()},render:function(){if(!h(this)){if(this.invalidate&&(this.invalidate=!1,r(this.element)&&(this.value=this.parent&&this.parent.html?this.parent.element.innerHTML=this.interpolation.render():this.element.nodeValue=this.interpolation.render())),this.attributes)for(var e=0,t=this.attributes.length;t>e;e++)this.attributes[e].render();this.repeater?j(this):C(this)}}};var wt=function(e,t,n){this.name=e,this.value=t,this.node=n,this.interpolationName=new Nt(this.name,null,this),this.interpolationValue=new Nt(this.value,null,this),this.invalidate=!1};wt.prototype={toString:function(){return"[object Attribute]"},dispose:function(){this.interpolationName&&this.interpolationName.dispose(),this.interpolationValue&&this.interpolationValue.dispose(),this.interpolationName=null,this.interpolationValue=null,this.node=null,this.name=null,this.value=null,this.previousName=null},update:function(){this.interpolationName.update(),this.interpolationValue.update()},render:function(){function e(e,t){7===gt&&"class"===e?r.className=t:r.setAttribute(e,t)}function t(e,t){o(e)?r.setAttribute(t,t):r.removeAttribute(t)}function n(e){r.setAttribute("src",e)}function i(e){r.setAttribute("href",e)}if(!this.node.repeater){var r=this.node.element;this.invalidate&&(this.invalidate=!1,this.previousName=this.name,this.name=s(this.interpolationName.render())?this.interpolationName.render():this.name,this.value=s(this.interpolationValue.render())?this.interpolationValue.render():this.value,this.name===ut.src?n(this.value):this.name===ut.href?i(this.value):((7!==gt||7===gt&&!this.node.isRepeaterChild)&&this.node.element.removeAttribute(this.interpolationName.value),this.previousName&&(7===gt&&"class"===this.previousName?this.node.element.className="":(7!==gt||7===gt&&!this.node.isRepeaterChild)&&this.node.element.removeAttribute(this.previousName)),e(this.name,this.value,this.previousName))),"class"===this.name&&-1!==this.value.indexOf(ot.attributes.cloak)&&E(this.node.element,ot.attributes.cloak),this.name===ut.hide&&(r.style.display=o(this.value)?"none":"block"),this.name===ut.show&&(r.style.display=o(this.value)?"block":"none"),this.name===ut.checked&&(t(this.value,"checked"),r.checked=o(this.value)?!0:!1),this.name===ut.disabled&&t(this.value,"disabled"),this.name===ut.multiple&&t(this.value,"multiple"),this.name===ut.readonly&&(7===gt?r.readOnly=o(this.value)?!0:!1:t(this.value,"readonly")),this.name===ut.selected&&t(this.value,"selected")}}};var Nt=function(e,t,n){this.value=t&&!r(t.element)?d(e):e,this.node=t,this.attribute=n,this.sequence=[],this.expressions=[];var i=this.value.match(mt.sequence);if(i){for(var a=0,s=i.length;s>a;a++)if(i[a].match(mt.token)){var o=new Rt(m(i[a]),this.node,this.attribute);this.sequence.push(o),this.expressions.push(o)}else this.sequence.push(i[a]);v(this.sequence)}};Nt.prototype={toString:function(){return"[object Interpolation]"},dispose:function(){if(this.expressions)for(var e=0,t=this.expressions.length;t>e;e++)this.expressions[e].dispose();this.value=null,this.node=null,this.attribute=null,this.sequence=null,this.expressions=null},update:function(){for(var e=-1,t=this.expressions.length;t>++e;)this.expressions[e].update()},render:function(){var e="";if(this.sequence)for(var t=0,n=this.sequence.length;n>t;t++){var i="";i=l(this.sequence[t])?this.sequence[t].value:this.sequence[t],s(i)||(i=""),e+=i}return e}};var Rt=function(e,t,n){s(e)&&(this.pattern=e,this.isString=mt.string.test(e),this.node=t,this.attribute=n,this.value=this.isString?this.pattern:void 0,this.isString?(this.isFunction=!1,this.depth=null,this.path=null,this.params=null):(this.isFunction=u(this.pattern),this.depth=P(this.pattern),this.path=A(this.pattern),this.params=this.isFunction?_(this.pattern.match(mt.func)[2]):null))};Rt.prototype={toString:function(){return"[object Expression]"},dispose:function(){this.pattern=null,this.node=null,this.attribute=null,this.path=null,this.params=null,this.value=null},update:function(){var e=this.node;if(!e&&this.attribute&&(e=this.attribute.node),e||!e.scope){var t=this.getValue(e.scope);t=k(this,t),this.value!==t&&(this.value=t,(this.node||this.attribute).invalidate=!0)}},getValue:function(e,t,n){return T(e,this.pattern,this.path,this.params,t,n)}};var kt=new w,xt=function(e){this.watchers=new w,this.node=null,this.scope=null,this.compile(e)};xt.prototype={toString:function(){return"[object Template]"},compile:function(e){e&&(this.element=e),this.node&&this.node.dispose(),this.node=H(this,this.element),this.node.root=!0,this.scope=this.node.scope},update:function(e){s(e)&&O(this.node.scope,e),this.node&&this.node.update()},render:function(e){this.update(e),this.node&&this.node.render()},invalidate:function(){this.node&&this.node.invalidateData()},watch:function(e,t){(n(e)||i(e))&&a(t)&&this.watchers.put(e,t)},unwatch:function(e){this.watchers.remove(e)},clearWatchers:function(){this.watchers.dispose()},clearEvents:function(){this.node.clearEvents()},getNode:function(e){return this.node.getNode(e)},dispose:function(){kt.remove(this.element),this.watchers&&this.watchers.dispose(),this.node&&this.node.dispose(),this.element=null,this.watchers=null,this.node=null}},F.guid=1,W.preventDefault=function(){this.returnValue=!1},W.stopPropagation=function(){this.cancelBubble=!0};var St,Tt=[],At=function(){function e(e){for(p=1;e=n.shift();)e()}var t,n=[],i=!1,r=document,a=r.documentElement,s=a.doScroll,o="DOMContentLoaded",l="addEventListener",u="onreadystatechange",h="readyState",p=/^loade|c/.test(r[h]);return r[l]&&r[l](o,t=function(){r.removeEventListener(o,t,i),e()},i),s&&r.attachEvent(u,t=function(){/^c/.test(r[h])&&(r.detachEvent(u,t),e())}),s?function(e){self!=top?p?e():n.push(e):function(){try{a.doScroll("left")}catch(t){return setTimeout(function(){At(e)},50)}e()}()}:function(e){p?e():n.push(e)}}();if(ot.autocreate&&"object"==typeof document){var _t=function(e){for(var t=e?e.firstChild:document.body;t;){if(1===t.nodeType){_t(t);var n=t.getAttribute(ut.template);if(n){var i=Function("return "+n+";");try{var r=i();a(r)&&nt.template.bootstrap(n,t,r)}catch(s){}}}t=t.nextSibling}};At(_t)}lt.start(it),lt.end(rt),nt.plugins=nt.plugins||{};var Pt=function(instance,injector){instance.constructor.prototype.createTemplate=function(e,t){if(!e||"function"!=typeof e)throw Error("Error creating a template, the first parameter must be a function.");if(t&&i(t)){var n=nt.template.create(t);for(var r in n)"function"==typeof n[r]&&(e.prototype[r]=n[r].bind(n));e.prototype.render=n.render.bind(n);var a=injector.createChild();return a.mapValue("template",n),a.mapValue("scope",n.scope),a.mapValue("element",n.element),a.createInstance(e)}return null},nt.template.bootstrap=function(e,t,n){instance.createTemplate(n,t)}};nt.plugins&&nt.plugins.add&&nt.plugins.add(Pt),nt.template.Plugin=Pt,nt.template.create=Y,nt.template.get=Z,nt.template.renderAll=et,nt.template.helpers=tt,nt.template.bootstrap=Q,nt.template.addEvent=F,nt.template.removeEvent=G,nt.template.parseEvents=z,nt.template.clearEvents=K,nt.template.ready=At,"function"==typeof define&&define.amd!==void 0&&define("soma-template",nt),"undefined"!=typeof module&&module.exports!==void 0?module.exports=nt:window.soma=nt})();