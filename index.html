<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>soma-template by soundstep</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<link rel="stylesheet" href="assets/gh-buttons/gh-buttons.css">
	<link rel="stylesheet" href="assets/styles/pygment/native.css">
	<link rel="stylesheet" href="assets/styles/styles.css">
	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
</head>
<body>
<div class="wrapper">
	<header>
		<h1>soma-template</h1>

		<p>Seamless DOM-based templates.</p>

		<ul>
			<li><a href="https://github.com/soundstep/soma-template/zipball/master">Download <strong>ZIP File</strong></a></li>
			<li><a href="https://github.com/soundstep/soma-template/tarball/master">Download <strong>TAR Ball</strong></a></li>
			<li><a href="https://github.com/soundstep/soma-template">View On <strong>GitHub</strong></a></li>
		</ul>
	</header>

	<section>

		<h1>What is soma-template?</h1>
		
		<p>A web template engine is a solution that is used to process web templates and content to produce an HTML output.</p>
		<p>While this is true for the most common web template engine, soma-template differs about the output process. soma-template will also produce an HTML output, but more precisely, will manipulate DOM nodes rather than producing a string that will be injected in the DOM.</p>
		<p>This results in a workflow that stays close to a normal HTML development as the template can be directly part of the DOM itself.</p>
		<p>soma-template is a lightweight library (4.7 KB). It is tested and works in all modern browsers and in Internet Explorer from version 7. Its performance will be directly related to the DOM manipulation performance of the browser itself. This is why today the library is very fast on <a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Google Chrome</a>, which I recommend.</p>

	</section>

	<section>

		<h1>Inspiration</h1>

		<p>The library probably wouldn't have been created without the fully featured framework developed by Google: <a href="http://angularjs.org/" target="_blank">AngularJS</a>. While the code itself has nothing to do with AngularJS, the concept has been greatly inspired by its template system and some similarities can be found. The library has been kept to a minimum to do a single job: update the DOM with content.</p>
		<p>The primary goal is to use the native DOM API, with a minimal destruction of the nodes. I also believe, as other developers, that DOM-based template engines are the future and will probably be one day be implemented in the browser itself. Google is probably working on that already as stated in this <a href="http://blog.stevensanderson.com/2012/08/01/rich-javascript-applications-the-seven-frameworks-throne-of-js-2012/">excellent post by Steven Sanderson</a>.</p>
		<p>So, a big thanks to the AngularJS team for a great inspiration, at least to me.</p>

	</section>

	<section>

		<h1>Installation</h1>

		<h3>Browser application</h3>
		<p><a href="https://github.com/soundstep/soma-template/tree/master/build" class="button icon tag" target="_blank">download soma-template</a></p>
		<p>You can also download a <a href="https://github.com/soundstep/soma-template/zipball/master">zip file</a> containing everything. Finally, add the script to your page:</p>
		<div class="codehilite"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;soma-template.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></pre></div>
		<h3>Node.js</h3>
		<div class="codehilite"><pre><span class="nx">$</span> <span class="nx">npm</span> <span class="nx">install</span> <span class="nx">soma</span><span class="o">-</span><span class="nx">template</span></pre></div>
		<div class="codehilite"><pre><span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;soma-template&quot;</span><span class="p">);</span></pre></div>

	</section>

	<section>

		<h1>What is a template?</h1>

		<p>A template is a DOM element that contains tokens, and these tokens will be replaced by data provided to the template. Here is an example:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;template&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>My name is <span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span></pre></div>
		<p>A token is an identifier surrounded by double curly braces (customizable). In this example "<code>name</code>" is the identifier and the template engine will try to find data to replace the token in the DOM element.</p>

	</section>

	<section>

		<h1>Create a template instance</h1>

		<p>There are three ways to create a template.</p>
		<h3>Targeting a dom element</h3>
		<p>This is the easiest way, and the one I recommend. The template is part of the DOM and a reference to it can be sent to the create function. A template instance will be returned, this is what will be used to render data inside it.</p>
		<p>Note that the tokens will appear in the DOM but the template engine provide a way to easily hide elements (such as the template itself) until the template is rendered. See the class name "<code>data-cloak</code>".</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;p&gt;</span>My name is <span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<h3>Providing a string</h3>
		<p>Instead of using an element directly, you can also send a string that represents the template. The template engine will inject the string as a real element inside the DOM, this is why you also need to specify an element target when you use a string template.</p>
		<p>Note that even if you create a template using a string, rendering data inside the template will be done in the same manner: using native DOM manipulation. More specifically, the DOM property <code>innerHTML</code> is never used to render a template in soma-template.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  <span class="kd">var</span> <span class="nx">templateString</span> <span class="o">=</span> <span class="s1">&#39;&lt;p&gt;My name is {{name}}.&lt;/p&gt;&#39;<span class="p">;</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">templateString</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<h3>Using a script tag</h3>
		<p>This method is similar to other template engines. Elements can be surrounded by script tags and to be injected in the DOM. There is no major advantage using this method as the template will inject it in the DOM as soon as you create the template instance. However this makes you able to compile it at a chosen moment and before that, it will never appear in the DOM.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">id=</span><span class="s">&quot;source&quot;</span> <span class="na">type=</span><span class="s">&quot;text/x-soma-template&quot;</span><span class="nt">&gt;</span>
  <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span><span class="o">&lt;/p&gt;</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">soma</span><span class="p">.</span><span class="nx">template</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">target</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span></pre></div>

	</section>

	<section>

		<h1>Render a template</h1>

		<p>Rendering a template is the action of sending data inside the template so it can find information to replace the tokens.</p>
		<p>This part will be much different than other template engines. The JSON format can of course still be used, but the way that it is sent to the template is different.</p>
		<p>The template instance is providing a property called <code>scope</code>. There is at least one scope per template, which is nothing more than an object with some special properties for the template engine.</p>
		<p>There can be more than one scope in some cases, see the special attribute <code>data-repeat</code>. The scope is the object that will be used to provide the data. In other words, the data is not sent to the template but assigned to the scope in a very easy and natural manner.</p>
		<h3>Simple rendering</h3>
		<p>Here is an example where a value is provided for an identifier named "<code>name</code>" (to keep the code short and simple, a <code>template</code> variable is used to refer to a template instance, see previous examples).</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;p&gt;</span>My name is <span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span> and my age is <span class="cp">{{</span><span class="nv">age</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;John&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p>This will result in the following:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;p&gt;</span>My name is John and my age is 21.<span class="nt">&lt;/p&gt;&lt;/div&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/c00Dvm?p=preview"class="button icon edit" target="_blank">try it yourself</a></p>
		<h3>JSON rendering</h3>
		<p>Another example with data received from an API call. The response can simply be assigned to a scope property and accessed using a dot notation.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span><span class="cp">{{</span><span class="nv">tweets.results.length</span><span class="cp">}}</span> tweets retrieved
  in <span class="cp">{{</span><span class="nv">tweets.completed_in</span><span class="cp">}}</span> seconds.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
	<span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://search.twitter.com/search.json?q=template&#39;</span><span class="p">,</span>
	  <span class="nx">dataType</span><span class="o">:</span><span class="s1">&#39;jsonp&#39;</span><span class="p">,</span>
	  <span class="nx">success</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">tweets</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
	    <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
	  <span class="p">}</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/kmuiYF?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

	</section>

	<section>

		<h1>Interpolation</h1>

		<p>A String interpolation makes an heavy use of string representation of data. It means insert a string or replace a variable with its value making string formatting very intuitive.</p>

		<h3>Attributes</h3>
		<p>You can add tokens in text nodes, but you can also use them in attribute names and values. In the following example, a class value is rendered, as well as the attribute name:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p</span> <span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span><span class="na">=&quot;</span><span class="cp">{{</span><span class="nv">value</span><span class="cp">}}</span><span class="na">&quot;</span><span class="nt">&gt;</span>The class used is: <span class="cp">{{</span><span class="nv">value</span><span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;class&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;color&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/oKtHEr?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>
		<p></p>
		<h3>Anything anywhere</h3>
		<p>You can use tokens in anything, but also anywhere, even in the middle of other strings.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">cla</span><span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span><span class="na">=</span><span class="s">&quot;</span><span class="cp">{{</span><span class="nv">value</span><span class="cp">}}</span><span class="s">lor&quot;</span><span class="nt">&gt;</span>
    Ren<span class="cp">{{</span><span class="nv">text1</span><span class="cp">}}</span>er any<span class="cp">{{</span><span class="nv">text2</span><span class="cp">}}</span>ng an<span class="cp">{{</span><span class="nv">text3</span><span class="cp">}}</span>re
  <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;ss&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;co&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">text1</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">text2</span> <span class="o">=</span> <span class="s2">&quot;thi&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">text3</span> <span class="o">=</span> <span class="s2">&quot;ywhe&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/a7lxQc?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Path access</h3>
		<p>A path, or dot notation, can be used in the token to access to specific data:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>My name is <span class="cp">{{</span><span class="nv">section.person.name</span><span class="cp">}}</span>
  and my age is <span class="cp">{{</span><span class="nv">section.person.age</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">section</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span> <span class="mi">21</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/Ofqcxe?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Function call</h3>

		<p>Function can also be called from the token, the value returned by the function will replace the token:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;p&gt;</span>My name is <span class="cp">{{</span><span class="nv">getName()</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;John&quot;</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/RHD7bK?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Function parameters</h3>

		<p>Parameters can be sent with a function call. They can be of two types: a string or a reference to another property in the scope:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;p&gt;</span>I am <span class="cp">{{</span><span class="nv">getAge</span><span class="o">(</span><span class="s2">&quot;21&quot;</span><span class="o">,</span> <span class="nv">years</span><span class="o">)</span><span class="cp">}}</span>.<span class="nt">&lt;/p&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">years</span> <span class="o">=</span> <span class="s2">&quot;years old&quot;</span><span class="p">,</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">getAge</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">age</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">age</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/umcx9f?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Mix everything</h3>

		<p>Paths, strings, functions, parameters, text node, attribute names and values, everything can be mixed altogether:</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;bold </span><span class="cp">{{</span><span class="nv">styles.color</span><span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    I am <span class="cp">{{</span><span class="nv">utils.makeOlder</span><span class="o">(</span><span class="nv">person.age</span><span class="o">,</span> <span class="s2">&quot;years old&quot;</span><span class="o">)</span><span class="cp">}}</span>.
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s2">&quot;color&quot;</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">age</span><span class="o">:</span> <span class="mi">21</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">utils</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">makeOlder</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">age</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">age</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/ZQbBYn?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

	</section>

	<section>

		<h1>Repeaters</h1>

		<p>A repeater is a special attribute (<code>data-repeat</code>) that will duplicate the current node. A repeater can be used to perform an iteration on an array or an object to display its content.</p>
		<p>The repeater attribute value is composed of three parts: a "current variable" that you can name as your convenience, the keyword "<code>in</code>" and the array or object target: "<code>my_var in my_array</code>".</p>
		<p>A scope will be created for each repeated node to avoid data conflict, and will have a reference to its parent. The template engine will automatically search in its scope parent in case it doesn't find data in its current scope.</p>

		<h3>Array repeater</h3>
		<p>Here is an example of an array repeater, an <code>$index</code> variable is also available on the current scope and can be passed to a function if needed.</p>
		<p>The node that contains the <code>data-repeat</code>, and everything inside, will be duplicated three times in this example. One for each item in the array <code>items</code>.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">data-repeat=</span><span class="s">&quot;item in items&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>[<span class="cp">{{$index</span><span class="cp">}}</span>] <span class="cp">{{</span><span class="nv">greet</span><span class="cp">}}</span> <span class="cp">{{</span><span class="nv">item.name</span><span class="cp">}}</span>!<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">greet</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;David&quot;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Mike&quot;</span> <span class="p">}</span>
  <span class="p">];</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/ZQbBYn?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Object repeater</h3>
		<p>You can also perform an iteration on an object, in this case a <code>$key</code> variable will be available on the current scope.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">data-repeat=</span><span class="s">&quot;item in items&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>[<span class="cp">{{$key}}</span>] <span class="cp">{{</span><span class="nv">greet</span><span class="cp">}}</span> <span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span>!<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">greet</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name1</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="nx">name2</span><span class="o">:</span> <span class="s2">&quot;David&quot;</span><span class="p">,</span>
    <span class="nx">name3</span><span class="o">:</span> <span class="s2">&quot;Mike&quot;</span>
  <span class="p">};</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/JQtbv6?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

	</section>

	<section>

		<h1>Scope</h1>

		<p>A scope provides a data model context for a template, and a new scope child is created for each item of a repeater to provide a new context and avoid data conflict.</p>
		<p>The following image illustrates a template scope that contains a child scope, which contains also another child scope, and so on. Notice that all variables names are identical but the values are probably different.</p>
		<p><img src="assets/images/scopes.jpg" alt="scopes"></p>
		<p><a href="http://plnkr.co/edit/JQtbv6?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>
		<p>Note that a scope parent can also be accessed using a parent path notation (also works with parameters):</p>
		<div class="codehilite"><pre><span class="cp">{{../item.name}}
{{../../getName(../$index)</span><span class="cp">}}</span></pre></div>

	</section>

	<section>

		<h1>Watchers</h1>

		<p>To provide flexibility, a specific rendering can be intercepted so you can alter it. They are called watchers, and you can watch either a token or an element.</p>

		<h3>Watch a token</h3>

		<p>The following example adds a watcher to the <code>date</code> token. The full string date received as a parameter will be formatted to display only the day, the month and the year.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;</span>Date formatted: <span class="cp">{{</span><span class="nv">date</span><span class="cp">}}</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="s2">&quot;Wed Nov 14 2012 02:31:20 GMT+0000 (GMT)&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">newValue</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\w{3} \d{2} \d{4}/</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">});</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/YCEXYb?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Watch an element</h3>

		<p>The following example is watching an element, which is a div. For convenience, the template engine will not only watch the token <code>{{color}}</code> in the div but will also watch any token that is a text node and a direct child of this div, the token <code>{{content}}</code> in this example.</p>
		<div class="codehilite"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;target&quot;</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">&quot;</span><span class="cp">{{</span><span class="nv">color</span><span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">content</span><span class="cp">}}</span><span class="nt">&lt;/div&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">&quot;color-red&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="s2">&quot;This text is not red&quot;</span><span class="p">;</span>
  <span class="nx">template</span><span class="p">.</span><span class="nx">watch</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oldValue</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">pattern</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">attribute</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">attribute</span><span class="p">)</span> <span class="k">return</span> <span class="s2">&quot;color-blue&quot;</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">return</span> <span class="nx">newValue</span> <span class="o">+</span> <span class="s2">&quot; and has been watched as well!&quot;</span><span class="p">;</span>
  <span class="p">});</span>
<span class="nx">template</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span></pre></div>
		<p><a href="http://plnkr.co/edit/ipjiWz?p=preview" class="button icon edit" target="_blank">try it yourself</a></p>

		<h3>Remove a watcher</h3>

	</section>

		<!-- jsdom
		<div class="codehilite"><pre><span class="kd">var</span> <span class="nx">jsdom</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;jsdom&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;./soma-template&quot;</span><span class="p">);</span>
<span class="nx">jsdom</span><span class="p">.</span><span class="nx">env</span><span class="p">(</span>
  <span class="s1">&#39;&lt;div id=&quot;ct&quot;&gt;My name is: {{name}}&lt;/div&gt;&#39;</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">&quot;http://code.jquery.com/jquery.js&quot;</span><span class="p">],</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">errors</span><span class="p">,</span> <span class="nb">window</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nb">document</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;ct&quot;</span><span class="p">));</span>
    <span class="nx">tpl</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;john&quot;</span><span class="p">;</span>
    <span class="nx">tpl</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;ct&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre></div>
	-->

	<footer>
		<p>
			<a href="https://twitter.com/soundstep" target="_blank">@soundstep</a><br/>
			<a href="http://www.soundstep.com" target="_blank">www.soundstep.com</a>
		</p>

		<p>
			<small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a>
			</small>
		</p>
	</footer>
</div>

<script src="assets/js/libs/modernizr.js"></script>
<script src="assets/js/libs/respond.js"></script>
<script src="assets/js/libs/scale.fix.js"></script>

<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-36294101-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

</script>

</body>
</html>